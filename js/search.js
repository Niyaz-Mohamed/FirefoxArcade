document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("searchbar"),t=document.getElementById("suggestions-list");let n=0;e.addEventListener("keydown",(function(t){"Enter"===t.key&&(t.preventDefault(),window.open("https://www.google.com/search?q="+encodeURIComponent(e.value)))}));["input","focus"].forEach((s=>e.addEventListener(s,(()=>{const s=e.value.trim();s?(t.style.display="block",(e=>{
//! Use cors proxy to bypass CORS error
const t=encodeURI(`https://corsproxy.io/?https://suggestqueries.google.com/complete/search?client=firefox&q=${e}`);return fetch(t).then((e=>e.json())).then((e=>e[1].slice(0,5)))})(s).then((s=>{(s=>{t.innerHTML="",s.unshift(e.value),s.forEach((e=>{const o=document.createElement("a");o.classList.add("suggestion-item"),0==s.indexOf(e)&&(n=0,o.classList.add("selected-suggestion")),o.textContent=e,o.href="https://www.google.com/search?q="+encodeURIComponent(e),t.appendChild(o)}))})(s)}))):t.style.display="none"})))),e.addEventListener("blur",(()=>{t.style.display="none"})),e.addEventListener("keydown",(function(s){if("ArrowUp"===s.key&&t.childElementCount>1){t.querySelector(`:nth-child(${n+1})`).classList.remove("selected-suggestion"),n=Math.abs((n-1+t.childElementCount)%t.childElementCount);const s=t.querySelector(`:nth-child(${n+1})`);s.classList.add("selected-suggestion"),e.value=s.innerHTML}else if("ArrowDown"===s.key&&t.childElementCount>1){t.querySelector(`:nth-child(${n+1})`).classList.remove("selected-suggestion"),n=Math.abs((n+1)%t.childElementCount);const s=t.querySelector(`:nth-child(${n+1})`);s.classList.add("selected-suggestion"),e.value=s.innerHTML}}))}));